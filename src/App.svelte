<script>
	import * as Tone from "tone";

	import Tine from "./Tine.svelte";

	let started = false;
	let loading = true;

	const notes = [
		"D4",
		"C4",
		"E4",
	]

	const sampler = new Tone.Sampler({
		urls: {
			"C4": "C4.wav",
		},
		baseUrl: "/",
	}).toDestination()

	Tone.loaded().then(() => {
		loading = false
	})

</script>

<style>
	.kalimba {
		display: flex;
		justify-content: center;
		background: salmon;
		height: 100%;
		padding: 20px;
	}

	.tines {
		background: orange;
		align-self: start;
		justify-content: center;
		padding: 30px;
		padding-top: 0;
		display: flex;
		align-items: start;
		border-radius: 30px;
		gap: 10px;
	}
</style>

{#if loading}
	<p>loading</p>
{:else if !started}
	<button
		on:click|preventDefault={async () => {
			await Tone.start();
			document.documentElement.requestFullscreen()
			started = true;
		}}>
		Start Tone
	</button>
{:else}
	<div class="kalimba">
		<div class="tines">
			{#each notes as note}
				<Tine {note} {sampler}/>
			{/each}
		</div>
	</div>
{/if}
